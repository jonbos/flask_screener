<!doctype html>
<title>{% block title %}{% endblock %} - Blog</title>
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
<nav>
    <h1>Stock Screener</h1>
    <ul>
        {% if g.user %}
            <li><span>{{ g.user['username'] }}</span>
            <li><a href="{{ url_for('auth.logout') }}">Log Out</a>
                {% else %}
            <li><a href="{{ url_for('auth.register') }}">Register</a>
            <li><a href="{{ url_for('auth.login') }}">Log In</a>
        {% endif %}
    </ul>
</nav>
<section class="content">
    <header>
        {% block header %}{% endblock %}
    </header>
    {% for message in get_flashed_messages() %}
        <div class="flash">{{ message }}</div>
    {% endfor %}
    {% block content %}{% endblock %}
    <div id="chart" class="chart" style="height: 300px;border: 1px solid;
                    box-shadow: 5px 5px 5px #888888;"/>
</section>
<script>
    const call_api = (ticker) => {
        url = "/api/stock?ticker={{ ticker }}"
        console.log(url)
        fetch(url).then(data => data.json()).then(res => {
            chartJson = res;
            Plotly.newPlot('chart', chartJson, {});
        })
    }
    call_api();
</script>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
